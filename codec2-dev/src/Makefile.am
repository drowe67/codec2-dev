AM_CFLAGS = -I../src -fPIC -Wall -O3
AUTOMAKE_OPTS = gnu
NAME = codec2
AM_CPPFLAGS = $(AM_CFLAGS)

D=codebook

# lsp quantisers

CODEBOOKS= \
  $D/lsp1.txt \
  $D/lsp2.txt \
  $D/lsp3.txt \
  $D/lsp4.txt \
  $D/lsp5.txt \
  $D/lsp6.txt \
  $D/lsp7.txt \
  $D/lsp8.txt \
  $D/lsp9.txt \
  $D/lsp10.txt

# lspd quantisers

CODEBOOKSD= \
  $D/dlsp1.txt \
  $D/dlsp2.txt \
  $D/dlsp3.txt \
  $D/dlsp4.txt \
  $(top_srcdir)/unittest/lsp45678910.txt

# lspd VQ quantisers

CODEBOOKSVQ= \
  $D/lsp1.txt \
  $D/lsp2.txt \
  $D/lsp3.txt \
  $D/lsp4.txt \
  $(top_srcdir)/unittest/lsp45678910.txt

CODEBOOKSJND= \
  $D/lsp1.txt \
  $D/lsp2.txt \
  $D/lsp3.txt \
  $D/lsp4.txt \
  $(top_srcdir)/unittest/lspjnd5-10.txt

CODEBOOKSDT= \
  $D/lspdt.txt

CODEBOOKSJVM= \
  $D/lspjvm1.txt \
  $D/lspjvm2.txt \
  $D/lspjvm3.txt

CODEBOOKSGE= \
  $D/gecb.txt 

noinst_PROGRAMS = generate_codebook genlspdtcb

codebook.$(OBJEXT): codebook.c
codebookd.$(OBJEXT): codebookd.c
codebookvq.$(OBJEXT): codebookvq.c
codebookjnd.$(OBJEXT): codebookjnd.c
codebookjvm.$(OBJEXT): codebookjvm.c
codebookge.$(OBJEXT): codebookge.c

$(CODEBOOKSDT): genlspdtcb
	./genlspdtcb

codebook.lo: codebook.c

codebook.c: generate_codebook $(CODEBOOKS)
	./generate_codebook lsp_cb $(CODEBOOKS) > codebook.c

codebookd.c: generate_codebook $(CODEBOOKSD)
	./generate_codebook lsp_cbd $(CODEBOOKSD) > codebookd.c

codebookvq.c: generate_codebook $(CODEBOOKSVQ)
	./generate_codebook lsp_cbvq $(CODEBOOKSVQ) > codebookvq.c

codebookjnd.c: generate_codebook $(CODEBOOKSJND)
	./generate_codebook lsp_cbjnd $(CODEBOOKSJND) > codebookjnd.c

codebookdt.c: generate_codebook $(CODEBOOKSDT)
	./generate_codebook lsp_cbdt $(CODEBOOKSDT) > codebookdt.c

codebookjvm.c: generate_codebook $(CODEBOOKSJVM)
	./generate_codebook lsp_cbjvm $(CODEBOOKSJVM) > codebookjvm.c

codebookge.c: generate_codebook $(CODEBOOKSGE)
	./generate_codebook ge_cb $(CODEBOOKSGE) > codebookge.c

clean-local:
	-rm -f codebook.c codebookd.c codebookdvq.c codebookjnd.c codebookdt.c codebookjvm.c codebookge.c

lib_LTLIBRARIES	= libcodec2.la
libcodec2_la_SOURCES = dump.c \
lpc.c \
nlp.c \
postfilter.c \
sine.c \
codec2.c \
fft.c \
kiss_fft.c \
interp.c \
lsp.c \
phase.c \
quantise.c \
pack.c \
codebook.c \
codebookd.c \
codebookvq.c \
codebookjnd.c \
codebookjvm.c \
codebookdt.c \
codebookge.c


libcodec2_la_CFLAGS = $(AM_CFLAGS)
libcodec2_la_LDFLAGS = $(LIBS)

library_includedir = $(prefix)
library_include_HEADERS	= codec2.h \
defines.h \
kiss_fft.h\
_kiss_fft_guts.h \
fft.h \
interp.h \
lsp.h \
phase.h \
quantise.h \
comp.h \
dump.h \
lpc.h \
nlp.h  \
postfilter.h \
sine.h

bin_PROGRAMS = c2demo c2enc c2dec c2sim

c2demo_SOURCES = c2demo.c
c2demo_LDADD = $(lib_LTLIBRARIES) 
c2demo_LDFLAGS = $(LIBS)

c2enc_SOURCES = c2enc.c
c2enc_LDADD = $(lib_LTLIBRARIES) 
c2enc_LDFLAGS = $(LIBS)

c2dec_SOURCES = c2dec.c
c2dec_LDADD = $(lib_LTLIBRARIES) 
c2dec_LDFLAGS = $(LIBS)

c2sim_SOURCES = c2sim.c
c2sim_LDADD = $(lib_LTLIBRARIES) 
c2sim_LDFLAGS = $(LIBS)
